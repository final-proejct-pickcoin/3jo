"use client"

import { useState } from "react"
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from "@/components/ui/card"
import { Button } from "@/components/ui/button"
import { Textarea } from "@/components/ui/textarea"
import { Badge } from "@/components/ui/badge"
import { Avatar, AvatarFallback, AvatarImage } from "@/components/ui/avatar"
import { Heart, MessageCircle, Share, Flag, Plus, TrendingUp, Users, Award } from "lucide-react"

const communityPosts = [
  {
    id: 1,
    author: "CryptoTrader_Pro",
    avatar: "/placeholder.svg?height=40&width=40&text=CT",
    time: "2ÏãúÍ∞Ñ Ï†Ñ",
    content:
      "Î∞©Í∏à ÎπÑÌä∏ÏΩîÏù∏ Ï∞®Ìä∏ Î∂ÑÏÑùÌï¥Î¥§ÎäîÎç∞, 4Îßå5Ï≤ú Îã¨Îü¨ ÎèåÌåå ÌùêÎ¶ÑÏù¥ Î≥¥ÏûÖÎãàÎã§. Í±∞ÎûòÎüâÎèÑ Í≥ÑÏÜç ÎäòÍ≥† ÏûàÍ≥†, RSIÎèÑ Í∞ïÌïú Îß§Ïàò Ïã†Ìò∏ÎÑ§Ïöî. Ïó¨Îü¨Î∂ÑÏùÄ Ïñ¥ÎñªÍ≤å Î≥¥ÏãúÎÇòÏöî?",
    likes: 24,
    comments: 8,
    tags: ["ÎπÑÌä∏ÏΩîÏù∏", "Ï∞®Ìä∏Î∂ÑÏÑù"],
    isLiked: false,
  },
  {
    id: 2,
    author: "DeFi_Explorer",
    avatar: "/placeholder.svg?height=40&width=40&text=DE",
    time: "4ÏãúÍ∞Ñ Ï†Ñ",
    content:
      "ÏÉàÎ°úÏö¥ ÎîîÌååÏù¥ ÌîÑÎ°úÌÜ†ÏΩú ÎÇòÏôîÎäîÎç∞, Ïä§ÌÖåÏù¥Î∏îÏΩîÏù∏ ÏòàÏπòÌïòÎ©¥ Ïó∞ 15% ÏàòÏùµ Ï§ÄÎåÄÏöî. Ïä§ÎßàÌä∏ Ïª®Ìä∏ÎûôÌä∏ÎèÑ ÏßÅÏ†ë ÌôïÏù∏Ìï¥Î¥§ÎäîÎç∞ ÍΩ§ ÎØøÏùÑ ÎßåÌïòÎÑ§Ïöî. ÌòπÏãú Ìï¥Î≥¥Ïã† Î∂Ñ Í≥ÑÏã†Í∞ÄÏöî?",
    likes: 18,
    comments: 12,
    tags: ["ÎîîÌååÏù¥", "ÏòàÏπòÏàòÏùµ"],
    isLiked: true,
  },
  {
    id: 3,
    author: "AltcoinHunter",
    avatar: "/placeholder.svg?height=40&width=40&text=AH",
    time: "6ÏãúÍ∞Ñ Ï†Ñ",
    content:
      "Ìè¨Ìä∏Ìè¥Î¶¨Ïò§ ÏóÖÎç∞Ïù¥Ìä∏! Ïù¥Î≤à Îã¨ SOL, MATIC ÎØ∏Î¶¨ Îã¥ÏïÑÏÑú 23% ÏàòÏùµ Ï§ëÏûÖÎãàÎã§. Ïó≠Ïãú Í∏∞Îã§Î¶ºÍ≥º ÏúÑÌóòÍ¥ÄÎ¶¨Í∞Ä Ï†úÏùº Ï§ëÏöîÌïú Í≤É Í∞ôÏïÑÏöî. Í∞êÎãπÌï† Ïàò ÏûàÎäî ÎßåÌÅºÎßå Ìà¨ÏûêÌïòÏÑ∏Ïöî!",
    likes: 45,
    comments: 15,
    tags: ["Ìè¨Ìä∏Ìè¥Î¶¨Ïò§", "ÏúÑÌóòÍ¥ÄÎ¶¨"],
    isLiked: false,
  },
]

const topTraders = [
  { name: "CryptoKing", profit: "+156%", followers: 2340, badge: "üèÜ" },
  { name: "BlockchainBull", profit: "+134%", followers: 1890, badge: "ü•à" },
  { name: "DeFiMaster", profit: "+128%", followers: 1650, badge: "ü•â" },
  { name: "AltcoinAce", profit: "+98%", followers: 1200, badge: "‚≠ê" },
]

// ÌÉúÍ∑∏ ÌïúÍ∏Ä Î≥ÄÌôò Ìï®Ïàò (Ï§ëÎ≥µ Ï†úÍ±∞)
const tagToKr = (tag) => {
  if (tag === "BTC" || tag === "ÎπÑÌä∏ÏΩîÏù∏") return "ÎπÑÌä∏ÏΩîÏù∏"
  if (tag === "ETH" || tag === "Ïù¥ÎçîÎ¶¨ÏõÄ") return "Ïù¥ÎçîÎ¶¨ÏõÄ"
  if (tag === "DeFi" || tag === "ÎîîÌååÏù¥") return "ÎîîÌååÏù¥"
  if (tag === "NFT") return "NFT"
  if (["Technical Analysis", "Í∏∞Ïà†Ï†Å Î∂ÑÏÑù", "Ï∞®Ìä∏Î∂ÑÏÑù"].includes(tag)) return "Ï∞®Ìä∏Î∂ÑÏÑù"
  if (tag === "News" || tag === "Îâ¥Ïä§") return "Îâ¥Ïä§"
  if (tag === "Portfolio" || tag === "Ìè¨Ìä∏Ìè¥Î¶¨Ïò§") return "Ìè¨Ìä∏Ìè¥Î¶¨Ïò§"
  if (tag === "Trading Tips" || tag === "Ìä∏Î†àÏù¥Îî© ÌåÅ") return "Ìä∏Î†àÏù¥Îî© ÌåÅ"
  if (["Yield Farming", "ÏàòÏùµ ÌååÎ∞ç", "ÏòàÏπòÏàòÏùµ"].includes(tag)) return "ÏòàÏπòÏàòÏùµ"
  if (["Risk Management", "Î¶¨Ïä§ÌÅ¨ Í¥ÄÎ¶¨", "ÏúÑÌóòÍ¥ÄÎ¶¨"].includes(tag)) return "ÏúÑÌóòÍ¥ÄÎ¶¨"
  return tag
}

export const CommunityHub = () => {
  const [posts, setPosts] = useState(communityPosts)
  const [newPost, setNewPost] = useState("")
  const [selectedTags, setSelectedTags] = useState([])
  const availableTags = ["BTC", "ETH", "DeFi", "NFT", "Technical Analysis", "News", "Portfolio", "Trading Tips"]
  const handleLike = (postId) => setPosts(posts.map(post => post.id === postId ? { ...post, isLiked: !post.isLiked, likes: post.isLiked ? post.likes - 1 : post.likes + 1 } : post))
  const handleCreatePost = () => {
    if (!newPost.trim()) return
    setPosts([{ id: Date.now(), author: "You", avatar: "/placeholder.svg?height=40&width=40&text=Y", time: "now", content: newPost, likes: 0, comments: 0, tags: selectedTags, isLiked: false }, ...posts])
    setNewPost("")
    setSelectedTags([])
  }
  return (
    <div className="grid lg:grid-cols-3 gap-6">
      {/* Main Feed */}
      <div className="lg:col-span-2 space-y-6">
        {/* Create Post */}
        <Card>
          <CardHeader>
            <CardTitle className="flex items-center gap-2">
              <MessageCircle className="h-5 w-5" />
              Ïª§ÎÆ§ÎãàÌã∞Ïóê Í≥µÏú†ÌïòÍ∏∞
            </CardTitle>
          </CardHeader>
          <CardContent>
            <div className="space-y-4">
              <Textarea
                placeholder="ÏÉùÍ∞Å, Î∂ÑÏÑù, Ìä∏Î†àÏù¥Îî© Ïù∏ÏÇ¨Ïù¥Ìä∏Î•º ÏûêÏú†Î°≠Í≤å ÎÇ®Í≤®Î≥¥ÏÑ∏Ïöî..."
                value={newPost}
                onChange={(e) => setNewPost(e.target.value)}
                className="min-h-[100px]"
              />

              <div className="flex flex-wrap gap-2">
                {availableTags.map((tag) => (
                  <Badge
                    key={tag}
                    variant={selectedTags.includes(tag) ? "default" : "outline"}
                    className="cursor-pointer"
                    onClick={() => setSelectedTags(selectedTags.includes(tag) ? selectedTags.filter((t) => t !== tag) : [...selectedTags, tag])}
                  >
                    {tagToKr(tag)}
                  </Badge>
                ))}
              </div>

              <div className="flex justify-between items-center">
                <p className="text-sm text-muted-foreground">{newPost.length}/500Ïûê</p>
                <Button onClick={handleCreatePost} disabled={!newPost.trim()}>
                  <Plus className="h-4 w-4 mr-2" />
                  Îì±Î°ù
                </Button>
              </div>
            </div>
          </CardContent>
        </Card>

        {/* Posts Feed */}
        <div className="space-y-4">
          {posts.map((post) => (
            <Card key={post.id}>
              <CardContent className="pt-6">
                <div className="flex items-start space-x-3">
                  <Avatar>
                    <AvatarImage src={post.avatar || "/placeholder.svg"} />
                    <AvatarFallback>{post.author.charAt(0)}</AvatarFallback>
                  </Avatar>

                  <div className="flex-1 space-y-3">
                    <div className="flex items-center justify-between">
                      <div>
                        <p className="font-semibold">{post.author}</p>
                        <p className="text-sm text-muted-foreground">{post.time}</p>
                      </div>
                      <Button variant="ghost" size="sm">
                        <Flag className="h-4 w-4" />
                      </Button>
                    </div>

                    <p className="text-sm leading-relaxed">{post.content}</p>

                    <div className="flex flex-wrap gap-2">
                      {post.tags.map((tag) => (
                        <Badge key={tag} variant="secondary" className="text-xs">
                          {tagToKr(tag)}
                        </Badge>
                      ))}
                    </div>

                    <div className="flex items-center space-x-4 pt-2">
                      <Button
                        variant="ghost"
                        size="sm"
                        onClick={() => handleLike(post.id)}
                        className={post.isLiked ? "text-red-500" : ""}
                      >
                        <Heart className={`h-4 w-4 mr-1 ${post.isLiked ? "fill-current" : ""}`} />
                        {post.likes}
                      </Button>

                      <Button variant="ghost" size="sm">
                        <MessageCircle className="h-4 w-4 mr-1" />
                        {post.comments}
                      </Button>

                      <Button variant="ghost" size="sm">
                        <Share className="h-4 w-4 mr-1" />
                        Í≥µÏú†
                      </Button>
                    </div>
                  </div>
                </div>
              </CardContent>
            </Card>
          ))}
        </div>
      </div>

      {/* Sidebar */}
      <div className="space-y-6">
        {/* Top Traders */}
        <Card>
          <CardHeader>
            <CardTitle className="flex items-center gap-2">
              <Award className="h-5 w-5" />
              ÏàòÏùµÎ•† ÏÉÅÏúÑ Ìä∏Î†àÏù¥Îçî
            </CardTitle>
            <CardDescription>Ïù¥Îã¨Ïùò Î≤†Ïä§Ìä∏ Ìä∏Î†àÏù¥Îçî</CardDescription>
          </CardHeader>
          <CardContent>
            <div className="space-y-4">
              {topTraders.map((trader, index) => (
                <div key={trader.name} className="flex items-center justify-between">
                  <div className="flex items-center space-x-3">
                    <span className="text-lg">{trader.badge}</span>
                    <div>
                      <p className="font-medium">{trader.name}</p>
                      <p className="text-sm text-muted-foreground">
                        <Users className="h-3 w-3 inline mr-1" />
                        ÌåîÎ°úÏõå {trader.followers.toLocaleString()}Î™Ö
                      </p>
                    </div>
                  </div>
                  <Badge className="bg-green-100 text-green-700">{trader.profit}</Badge>
                </div>
              ))}
            </div>
          </CardContent>
        </Card>

        {/* Trending Topics */}
        <Card>
          <CardHeader>
            <CardTitle className="flex items-center gap-2">
              <TrendingUp className="h-5 w-5" />
              Ïù∏Í∏∞ ÌÜ†ÌîΩ
            </CardTitle>
          </CardHeader>
          <CardContent>
            <div className="space-y-3">
              {[
                { tag: "#ÎπÑÌä∏ÏΩîÏù∏ETF", posts: 234 },
                { tag: "#ÎîîÌååÏù¥ÏàòÏùµ", posts: 189 },
                { tag: "#ÏïåÌä∏ÏΩîÏù∏ÏãúÏ¶å", posts: 156 },
                { tag: "#Í∏∞Ïà†Ï†ÅÎ∂ÑÏÑù", posts: 143 },
                { tag: "#ÌÅ¨Î¶ΩÌÜ†Îâ¥Ïä§", posts: 98 },
              ].map((topic) => (
                <div key={topic.tag} className="flex items-center justify-between">
                  <span className="font-medium text-primary cursor-pointer hover:underline">{topic.tag}</span>
                  <span className="text-sm text-muted-foreground">{topic.posts}Í±¥</span>
                </div>
              ))}
            </div>
          </CardContent>
        </Card>

        {/* Community Stats */}
        <Card>
          <CardHeader>
            <CardTitle>Ïª§ÎÆ§ÎãàÌã∞ ÌÜµÍ≥Ñ</CardTitle>
          </CardHeader>
          <CardContent>
            <div className="space-y-4">
              <div className="flex justify-between">
                <span className="text-muted-foreground">ÌôúÎèô ÌöåÏõê</span>
                <span className="font-semibold">12,456</span>
              </div>
              <div className="flex justify-between">
                <span className="text-muted-foreground">Ïò§ÎäòÏùò Í≤åÏãúÍ∏Ä</span>
                <span className="font-semibold">89</span>
              </div>
              <div className="flex justify-between">
                <span className="text-muted-foreground">ÌòÑÏû¨ Ï†ëÏÜçÏûê</span>
                <span className="font-semibold text-green-500">1,234</span>
              </div>
              <div className="flex justify-between">
                <span className="text-muted-foreground">ÎàÑÏ†Å ÌÜ†Î°† Ïàò</span>
                <span className="font-semibold">45,678</span>
              </div>
            </div>
          </CardContent>
        </Card>
      </div>
    </div>
  )
}
